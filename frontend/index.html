<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Verifier</title>
</head>
<body>
    <h1>Upload and Verify Document Hash</h1>

    <!-- File input for document -->
    <input type="file" id="documentFile" />

    <!-- Button to upload and verify document -->
    <button id="verifyButton">Upload and Verify Document</button>

    <!-- Status message -->
    <p id="status"></p>

    <script src="https://cdn.jsdelivr.net/npm/ethers@5.4.0/dist/ethers.umd.min.js"></script>
    <script>
        // Function to hash the document file
        async function hashDocument(file) {
            const arrayBuffer = await file.arrayBuffer();
            const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // Function to connect user wallet (MetaMask)
        async function connectWallet() {
            if (window.ethereum) {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    const provider = new ethers.providers.Web3Provider(window.ethereum);
                    const signer = provider.getSigner();
                    const contract = new ethers.Contract("0x90193C961A926261B756D1E5bb255e67ff9498A1", [{"abi":[{"type":"function","name":"documents","inputs":[{"name":"","type":"string","internalType":"string"}],"outputs":[{"name":"owner","type":"address","internalType":"address"},{"name":"documentHash","type":"string","internalType":"string"},{"name":"revoked","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"issueDocument","inputs":[{"name":"_documentHash","type":"string","internalType":"string"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"revokeDocument","inputs":[{"name":"_documentHash","type":"string","internalType":"string"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferDocument","inputs":[{"name":"_documentHash","type":"string","internalType":"string"},{"name":"_newOwner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"verifyDocument","inputs":[{"name":"_documentHash","type":"string","internalType":"string"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"event","name":"DocumentIssued","inputs":[{"name":"documentHash","type":"string","indexed":true,"internalType":"string"},{"name":"owner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"DocumentRevoked","inputs":[{"name":"documentHash","type":"string","indexed":true,"internalType":"string"}],"anonymous":false},{"type":"event","name":"DocumentTransferred","inputs":[{"name":"documentHash","type":"string","indexed":true,"internalType":"string"},{"name":"newOwner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false}],"bytecode":{"object":"0x6080604052348015600f57600080fd5b506109038061001f6000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c8063029ba59b1461005c5780636925f59714610071578063b3dd697b14610084578063beee5eb7146100af578063faff6eb5146100d2575b600080fd5b61006f61006a366004610660565b6100e5565b005b61006f61007f366004610660565b6101d7565b610097610092366004610660565b61032b565b6040516100a6939291906106c1565b60405180910390f35b6100c26100bd366004610660565b6103ee565b60405190151581526020016100a6565b61006f6100e036600461070b565b61045a565b336001600160a01b03166000826040516100ff9190610769565b908152604051908190036020019020546001600160a01b0316146101635760405162461bcd60e51b81526020600482015260166024820152752737ba103a3432903237b1bab6b2b73a1037bbb732b960511b60448201526064015b60405180910390fd5b60016000826040516101759190610769565b908152604051908190036020018120600201805492151560ff19909316929092179091556101a4908290610769565b604051908190038120907fb39143ea60a5a5412de9b664f527b5520e36c68532826fd2cf34b68588a9186390600090a250565b60006001600160a01b03166000826040516101f29190610769565b908152604051908190036020019020546001600160a01b0316146102585760405162461bcd60e51b815260206004820152601760248201527f446f63756d656e7420616c726561647920697373756564000000000000000000604482015260640161015a565b6040518060600160405280336001600160a01b031681526020018281526020016000151581525060008260405161028f9190610769565b90815260405160209181900382019020825181546001600160a01b0319166001600160a01b039091161781559082015160018201906102ce908261080e565b50604091820151600291909101805460ff19169115159190911790555133906102f8908390610769565b604051908190038120907fb5f1b91bf2cfd0093e5d050dcefa0120eebe50f1ad382383f58576fd5aa427a690600090a350565b8051602081830181018051600082529282019190930120915280546001820180546001600160a01b03909216929161036290610785565b80601f016020809104026020016040519081016040528092919081815260200182805461038e90610785565b80156103db5780601f106103b0576101008083540402835291602001916103db565b820191906000526020600020905b8154815290600101906020018083116103be57829003601f168201915b5050506002909301549192505060ff1683565b6000806001600160a01b031660008360405161040a9190610769565b908152604051908190036020019020546001600160a01b031614801590610454575060008260405161043c9190610769565b9081526040519081900360200190206002015460ff16155b92915050565b336001600160a01b03166000836040516104749190610769565b908152604051908190036020019020546001600160a01b0316146104d35760405162461bcd60e51b81526020600482015260166024820152752737ba103a3432903237b1bab6b2b73a1037bbb732b960511b604482015260640161015a565b6000826040516104e39190610769565b9081526040519081900360200190206002015460ff161561053c5760405162461bcd60e51b8152602060048201526013602482015272111bd8dd5b595b9d081a5cc81c995d9bdad959606a1b604482015260640161015a565b8060008360405161054d9190610769565b90815260405190819003602001812080546001600160a01b039384166001600160a01b031990911617905590821690610587908490610769565b604051908190038120907f2fab97472d04fb007cbd5fa35bd645134a268e0e501903bbad82670e9c87241590600090a35050565b634e487b7160e01b600052604160045260246000fd5b600082601f8301126105e257600080fd5b813567ffffffffffffffff8111156105fc576105fc6105bb565b604051601f8201601f19908116603f0116810167ffffffffffffffff8111828210171561062b5761062b6105bb565b60405281815283820160200185101561064357600080fd5b816020850160208301376000918101602001919091529392505050565b60006020828403121561067257600080fd5b813567ffffffffffffffff81111561068957600080fd5b610695848285016105d1565b949350505050565b60005b838110156106b85781810151838201526020016106a0565b50506000910152565b60018060a01b038416815260606020820152600083518060608401526106ee81608085016020880161069d565b921515604083015250601f91909101601f19160160800192915050565b6000806040838503121561071e57600080fd5b823567ffffffffffffffff81111561073557600080fd5b610741858286016105d1565b92505060208301356001600160a01b038116811461075e57600080fd5b809150509250929050565b6000825161077b81846020870161069d565b9190910192915050565b600181811c9082168061079957607f821691505b6020821081036107b957634e487b7160e01b600052602260045260246000fd5b50919050565b601f82111561080957806000526020600020601f840160051c810160208510156107e65750805b601f840160051c820191505b8181101561080657600081556001016107f2565b50505b505050565b815167ffffffffffffffff811115610828576108286105bb565b61083c816108368454610785565b846107bf565b6020601f82116001811461087057600083156108585750848201515b600019600385901b1c1916600184901b178455610806565b600084815260208120601f198516915b828110156108a05787850151825560209485019460019092019101610880565b50848210156108be5786840151600019600387901b60f8161c191681555b50505050600190811b0190555056fea2646970667358221220d539d9805060b374f4f06d95bae0c972bc777b96a770a6896ffb3e5e9425378364736f6c634300081a0033","sourceMap":"148:3836:20:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561001057600080fd5b50600436106100575760003560e01c8063029ba59b1461005c5780636925f59714610071578063b3dd697b14610084578063beee5eb7146100af578063faff6eb5146100d2575b600080fd5b61006f61006a366004610660565b6100e5565b005b61006f61007f366004610660565b6101d7565b610097610092366004610660565b61032b565b6040516100a6939291906106c1565b60405180910390f35b6100c26100bd366004610660565b6103ee565b60405190151581526020016100a6565b61006f6100e036600461070b565b61045a565b336001600160a01b03166000826040516100ff9190610769565b908152604051908190036020019020546001600160a01b0316146101635760405162461bcd60e51b81526020600482015260166024820152752737ba103a3432903237b1bab6b2b73a1037bbb732b960511b60448201526064015b60405180910390fd5b60016000826040516101759190610769565b908152604051908190036020018120600201805492151560ff19909316929092179091556101a4908290610769565b604051908190038120907fb39143ea60a5a5412de9b664f527b5520e36c68532826fd2cf34b68588a9186390600090a250565b60006001600160a01b03166000826040516101f29190610769565b908152604051908190036020019020546001600160a01b0316146102585760405162461bcd60e51b815260206004820152601760248201527f446f63756d656e7420616c726561647920697373756564000000000000000000604482015260640161015a565b6040518060600160405280336001600160a01b031681526020018281526020016000151581525060008260405161028f9190610769565b90815260405160209181900382019020825181546001600160a01b0319166001600160a01b039091161781559082015160018201906102ce908261080e565b50604091820151600291909101805460ff19169115159190911790555133906102f8908390610769565b604051908190038120907fb5f1b91bf2cfd0093e5d050dcefa0120eebe50f1ad382383f58576fd5aa427a690600090a350565b8051602081830181018051600082529282019190930120915280546001820180546001600160a01b03909216929161036290610785565b80601f016020809104026020016040519081016040528092919081815260200182805461038e90610785565b80156103db5780601f106103b0576101008083540402835291602001916103db565b820191906000526020600020905b8154815290600101906020018083116103be57829003601f168201915b5050506002909301549192505060ff1683565b6000806001600160a01b031660008360405161040a9190610769565b908152604051908190036020019020546001600160a01b031614801590610454575060008260405161043c9190610769565b9081526040519081900360200190206002015460ff16155b92915050565b336001600160a01b03166000836040516104749190610769565b908152604051908190036020019020546001600160a01b0316146104d35760405162461bcd60e51b81526020600482015260166024820152752737ba103a3432903237b1bab6b2b73a1037bbb732b960511b604482015260640161015a565b6000826040516104e39190610769565b9081526040519081900360200190206002015460ff161561053c5760405162461bcd60e51b8152602060048201526013602482015272111bd8dd5b595b9d081a5cc81c995d9bdad959606a1b604482015260640161015a565b8060008360405161054d9190610769565b90815260405190819003602001812080546001600160a01b039384166001600160a01b031990911617905590821690610587908490610769565b604051908190038120907f2fab97472d04fb007cbd5fa35bd645134a268e0e501903bbad82670e9c87241590600090a35050565b634e487b7160e01b600052604160045260246000fd5b600082601f8301126105e257600080fd5b813567ffffffffffffffff8111156105fc576105fc6105bb565b604051601f8201601f19908116603f0116810167ffffffffffffffff8111828210171561062b5761062b6105bb565b60405281815283820160200185101561064357600080fd5b816020850160208301376000918101602001919091529392505050565b60006020828403121561067257600080fd5b813567ffffffffffffffff81111561068957600080fd5b610695848285016105d1565b949350505050565b60005b838110156106b85781810151838201526020016106a0565b50506000910152565b60018060a01b038416815260606020820152600083518060608401526106ee81608085016020880161069d565b921515604083015250601f91909101601f19160160800192915050565b6000806040838503121561071e57600080fd5b823567ffffffffffffffff81111561073557600080fd5b610741858286016105d1565b92505060208301356001600160a01b038116811461075e57600080fd5b809150509250929050565b6000825161077b81846020870161069d565b9190910192915050565b600181811c9082168061079957607f821691505b6020821081036107b957634e487b7160e01b600052602260045260246000fd5b50919050565b601f82111561080957806000526020600020601f840160051c810160208510156107e65750805b601f840160051c820191505b8181101561080657600081556001016107f2565b50505b505050565b815167ffffffffffffffff811115610828576108286105bb565b61083c816108368454610785565b846107bf565b6020601f82116001811461087057600083156108585750848201515b600019600385901b1c1916600184901b178455610806565b600084815260208120601f198516915b828110156108a05787850151825560209485019460019092019101610880565b50848210156108be5786840151600019600387901b60f8161c191681555b50505050600190811b0190555056fea2646970667358221220d539d9805060b374f4f06d95bae0c972bc777b96a770a6896ffb3e5e9425378364736f6c634300081a0033","sourceMap":"148:3836:20:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;3137:353;;;;;;:::i;:::-;;:::i;:::-;;1779;;;;;;:::i;:::-;;:::i;707:44::-;;;;;;:::i;:::-;;:::i;:::-;;;;;;;;;:::i;:::-;;;;;;;;3752:230;;;;;;:::i;:::-;;:::i;:::-;;;2205:14:21;;2198:22;2180:41;;2168:2;2153:18;3752:230:20;2040:187:21;2453:489:20;;;;;;:::i;:::-;;:::i;3137:353::-;3251:10;-1:-1:-1;;;;;3217:44:20;:9;3227:13;3217:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:30;-1:-1:-1;;;;;3217:30:20;:44;3209:79;;;;-1:-1:-1;;;3209:79:20;;3229:2:21;3209:79:20;;;3211:21:21;3268:2;3248:18;;;3241:30;-1:-1:-1;;;3287:18:21;;;3280:52;3349:18;;3209:79:20;;;;;;;;;3363:4;3328:9;3338:13;3328:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:32;;:39;;;;;-1:-1:-1;;3328:39:20;;;;;;;;;;3414:30;;3430:13;;3414:30;:::i;:::-;;;;;;;;;;;;;;;3137:353;:::o;1779:::-;1900:1;-1:-1:-1;;;;;1858:44:20;:9;1868:13;1858:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:30;-1:-1:-1;;;;;1858:30:20;:44;1850:80;;;;-1:-1:-1;;;1850:80:20;;3580:2:21;1850:80:20;;;3562:21:21;3619:2;3599:18;;;3592:30;3658:25;3638:18;;;3631:53;3701:18;;1850:80:20;3378:347:21;1850:80:20;1967:42;;;;;;;;1976:10;-1:-1:-1;;;;;1967:42:20;;;;;1988:13;1967:42;;;;2003:5;1967:42;;;;;1940:9;1950:13;1940:24;;;;;;:::i;:::-;;;;;;;;;;;;;;;:69;;;;-1:-1:-1;;;;;;1940:69:20;-1:-1:-1;;;;;1940:69:20;;;;;;;;;;-1:-1:-1;1940:69:20;;;;;;;:::i;:::-;-1:-1:-1;1940:69:20;;;;;;;;;;;;-1:-1:-1;;1940:69:20;;;;;;;;;;2047:41;2077:10;;2047:41;;2062:13;;2047:41;:::i;:::-;;;;;;;;;;;;;;;1779:353;:::o;707:44::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;707:44:20;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;707:44:20;;;;;;;-1:-1:-1;;707:44:20;;;:::o;3752:230::-;3828:4;3894:1;-1:-1:-1;;;;;3852:44:20;:9;3862:13;3852:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:30;-1:-1:-1;;;;;3852:30:20;:44;;;;:81;;;3901:9;3911:13;3901:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:32;;;;;3900:33;3852:81;3844:90;3752:230;-1:-1:-1;;3752:230:20:o;2453:489::-;2588:10;-1:-1:-1;;;;;2554:44:20;:9;2564:13;2554:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:30;-1:-1:-1;;;;;2554:30:20;:44;2546:79;;;;-1:-1:-1;;;2546:79:20;;3229:2:21;2546:79:20;;;3211:21:21;3268:2;3248:18;;;3241:30;-1:-1:-1;;;3287:18:21;;;3280:52;3349:18;;2546:79:20;3027:346:21;2546:79:20;2674:9;2684:13;2674:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:32;;;;;2673:33;2665:65;;;;-1:-1:-1;;;2665:65:20;;6441:2:21;2665:65:20;;;6423:21:21;6480:2;6460:18;;;6453:30;-1:-1:-1;;;6499:18:21;;;6492:49;6558:18;;2665:65:20;6239:343:21;2665:65:20;2807:9;2774;2784:13;2774:24;;;;;;:::i;:::-;;;;;;;;;;;;;;:42;;-1:-1:-1;;;;;2774:42:20;;;-1:-1:-1;;;;;;2774:42:20;;;;;;2853:45;;;;;;2873:13;;2853:45;:::i;:::-;;;;;;;;;;;;;;;2453:489;;:::o;14:127:21:-;75:10;70:3;66:20;63:1;56:31;106:4;103:1;96:15;130:4;127:1;120:15;146:726;189:5;242:3;235:4;227:6;223:17;219:27;209:55;;260:1;257;250:12;209:55;300:6;287:20;330:18;322:6;319:30;316:56;;;352:18;;:::i;:::-;401:2;395:9;493:2;455:17;;-1:-1:-1;;451:31:21;;;484:2;447:40;443:54;431:67;;528:18;513:34;;549:22;;;510:62;507:88;;;575:18;;:::i;:::-;611:2;604:22;635;;;676:19;;;697:4;672:30;669:39;-1:-1:-1;666:59:21;;;721:1;718;711:12;666:59;785:6;778:4;770:6;766:17;759:4;751:6;747:17;734:58;840:1;812:19;;;833:4;808:30;801:41;;;;816:6;146:726;-1:-1:-1;;;146:726:21:o;877:322::-;946:6;999:2;987:9;978:7;974:23;970:32;967:52;;;1015:1;1012;1005:12;967:52;1055:9;1042:23;1088:18;1080:6;1077:30;1074:50;;;1120:1;1117;1110:12;1074:50;1143;1185:7;1176:6;1165:9;1161:22;1143:50;:::i;:::-;1133:60;877:322;-1:-1:-1;;;;877:322:21:o;1204:250::-;1289:1;1299:113;1313:6;1310:1;1307:13;1299:113;;;1389:11;;;1383:18;1370:11;;;1363:39;1335:2;1328:10;1299:113;;;-1:-1:-1;;1446:1:21;1428:16;;1421:27;1204:250::o;1459:576::-;1687:1;1683;1678:3;1674:11;1670:19;1662:6;1658:32;1647:9;1640:51;1727:2;1722;1711:9;1707:18;1700:30;1621:4;1759:6;1753:13;1802:6;1797:2;1786:9;1782:18;1775:34;1818:80;1891:6;1885:3;1874:9;1870:19;1865:2;1857:6;1853:15;1818:80;:::i;:::-;2013:14;;2006:22;2001:2;1986:18;;1979:50;-1:-1:-1;1959:2:21;1938:15;;;;-1:-1:-1;;1934:29:21;1919:45;1966:3;1915:55;;1459:576;-1:-1:-1;;1459:576:21:o;2232:496::-;2310:6;2318;2371:2;2359:9;2350:7;2346:23;2342:32;2339:52;;;2387:1;2384;2377:12;2339:52;2427:9;2414:23;2460:18;2452:6;2449:30;2446:50;;;2492:1;2489;2482:12;2446:50;2515;2557:7;2548:6;2537:9;2533:22;2515:50;:::i;:::-;2505:60;-1:-1:-1;;2615:2:21;2600:18;;2587:32;-1:-1:-1;;;;;2648:31:21;;2638:42;;2628:70;;2694:1;2691;2684:12;2628:70;2717:5;2707:15;;;2232:496;;;;;:::o;2733:289::-;2864:3;2902:6;2896:13;2918:66;2977:6;2972:3;2965:4;2957:6;2953:17;2918:66;:::i;:::-;3000:16;;;;;2733:289;-1:-1:-1;;2733:289:21:o;3730:380::-;3809:1;3805:12;;;;3852;;;3873:61;;3927:4;3919:6;3915:17;3905:27;;3873:61;3980:2;3972:6;3969:14;3949:18;3946:38;3943:161;;4026:10;4021:3;4017:20;4014:1;4007:31;4061:4;4058:1;4051:15;4089:4;4086:1;4079:15;3943:161;;3730:380;;;:::o;4241:518::-;4343:2;4338:3;4335:11;4332:421;;;4379:5;4376:1;4369:16;4423:4;4420:1;4410:18;4493:2;4481:10;4477:19;4474:1;4470:27;4464:4;4460:38;4529:4;4517:10;4514:20;4511:47;;;-1:-1:-1;4552:4:21;4511:47;4607:2;4602:3;4598:12;4595:1;4591:20;4585:4;4581:31;4571:41;;4662:81;4680:2;4673:5;4670:13;4662:81;;;4739:1;4725:16;;4706:1;4695:13;4662:81;;;4666:3;;4332:421;4241:518;;;:::o;4935:1299::-;5061:3;5055:10;5088:18;5080:6;5077:30;5074:56;;;5110:18;;:::i;:::-;5139:97;5229:6;5189:38;5221:4;5215:11;5189:38;:::i;:::-;5183:4;5139:97;:::i;:::-;5285:4;5316:2;5305:14;;5333:1;5328:649;;;;6021:1;6038:6;6035:89;;;-1:-1:-1;6090:19:21;;;6084:26;6035:89;-1:-1:-1;;4892:1:21;4888:11;;;4884:24;4880:29;4870:40;4916:1;4912:11;;;4867:57;6137:81;;5298:930;;5328:649;4188:1;4181:14;;;4225:4;4212:18;;-1:-1:-1;;5364:20:21;;;5482:222;5496:7;5493:1;5490:14;5482:222;;;5578:19;;;5572:26;5557:42;;5685:4;5670:20;;;;5638:1;5626:14;;;;5512:12;5482:222;;;5486:3;5732:6;5723:7;5720:19;5717:201;;;5793:19;;;5787:26;-1:-1:-1;;5876:1:21;5872:14;;;5888:3;5868:24;5864:37;5860:42;5845:58;5830:74;;5717:201;-1:-1:-1;;;;5964:1:21;5948:14;;;5944:22;5931:36;;-1:-1:-1;4935:1299:21:o","linkReferences":{}},"methodIdentifiers":{"documents(string)":"b3dd697b","issueDocument(string)":"6925f597","revokeDocument(string)":"029ba59b","transferDocument(string,address)":"faff6eb5","verifyDocument(string)":"beee5eb7"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.26+commit.8a97fa7a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"string\",\"name\":\"documentHash\",\"type\":\"string\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"}],\"name\":\"DocumentIssued\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"string\",\"name\":\"documentHash\",\"type\":\"string\"}],\"name\":\"DocumentRevoked\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"string\",\"name\":\"documentHash\",\"type\":\"string\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"DocumentTransferred\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"name\":\"documents\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"},{\"internalType\":\"string\",\"name\":\"documentHash\",\"type\":\"string\"},{\"internalType\":\"bool\",\"name\":\"revoked\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"_documentHash\",\"type\":\"string\"}],\"name\":\"issueDocument\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"_documentHash\",\"type\":\"string\"}],\"name\":\"revokeDocument\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"_documentHash\",\"type\":\"string\"},{\"internalType\":\"address\",\"name\":\"_newOwner\",\"type\":\"address\"}],\"name\":\"transferDocument\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"_documentHash\",\"type\":\"string\"}],\"name\":\"verifyDocument\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"events\":{\"DocumentIssued(string,address)\":{\"params\":{\"documentHash\":\"The unique hash of the issued document.\",\"owner\":\"The address of the document's owner (issuer).\"}},\"DocumentRevoked(string)\":{\"params\":{\"documentHash\":\"The unique hash of the revoked document.\"}},\"DocumentTransferred(string,address)\":{\"params\":{\"documentHash\":\"The unique hash of the transferred document.\",\"newOwner\":\"The address of the new owner.\"}}},\"kind\":\"dev\",\"methods\":{\"issueDocument(string)\":{\"details\":\"Ensures the document is not already issued by checking the owner of the document hash.\",\"params\":{\"_documentHash\":\"The unique hash of the document to be issued.\"}},\"revokeDocument(string)\":{\"details\":\"Can only be called by the current owner of the document.\",\"params\":{\"_documentHash\":\"The unique hash of the document to revoke.\"}},\"transferDocument(string,address)\":{\"details\":\"Can only be called by the current owner and the document must not be revoked.\",\"params\":{\"_documentHash\":\"The unique hash of the document to transfer.\",\"_newOwner\":\"The address of the new owner of the document.\"}},\"verifyDocument(string)\":{\"params\":{\"_documentHash\":\"The unique hash of the document to verify.\"},\"returns\":{\"_0\":\"Returns true if the document is valid (not revoked and exists), false otherwise.\"}}},\"stateVariables\":{\"documents\":{\"details\":\"The key is the document's hash and the value is the Document struct.\"}},\"title\":\"DocumentRegistry - A contract to issue, transfer, revoke, and verify documents.\",\"version\":1},\"userdoc\":{\"events\":{\"DocumentIssued(string,address)\":{\"notice\":\"Event emitted when a document is issued.\"},\"DocumentRevoked(string)\":{\"notice\":\"Event emitted when a document is revoked.\"},\"DocumentTransferred(string,address)\":{\"notice\":\"Event emitted when a document is transferred to a new owner.\"}},\"kind\":\"user\",\"methods\":{\"documents(string)\":{\"notice\":\"A mapping of document hashes to their corresponding Document details.\"},\"issueDocument(string)\":{\"notice\":\"Function to issue a new document by associating its hash with the sender's address.\"},\"revokeDocument(string)\":{\"notice\":\"Function to revoke a document.\"},\"transferDocument(string,address)\":{\"notice\":\"Function to transfer ownership of a document to a new address.\"},\"verifyDocument(string)\":{\"notice\":\"Function to verify if a document is valid (exists and is not revoked).\"}},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/DocumentRegistry.sol\":\"DocumentRegistry\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":ds-test/=lib/openzeppelin-contracts/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\"]},\"sources\":{\"src/DocumentRegistry.sol\":{\"keccak256\":\"0xf408a80f719d35ff628beff796f5350a092ef565d0ca76d259599d956e27f187\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://534a0bc5dd9fa3103de7540fa736b51536d05d6f6e4e64c7cde591301546f9ab\",\"dweb:/ipfs/QmQZGPtvvAj4ufLbkcy9rkW8chZRS7XQ1D4P4xykGNjUah\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.26+commit.8a97fa7a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"string","name":"documentHash","type":"string","indexed":true},{"internalType":"address","name":"owner","type":"address","indexed":true}],"type":"event","name":"DocumentIssued","anonymous":false},{"inputs":[{"internalType":"string","name":"documentHash","type":"string","indexed":true}],"type":"event","name":"DocumentRevoked","anonymous":false},{"inputs":[{"internalType":"string","name":"documentHash","type":"string","indexed":true},{"internalType":"address","name":"newOwner","type":"address","indexed":true}],"type":"event","name":"DocumentTransferred","anonymous":false},{"inputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","name":"documents","outputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"string","name":"documentHash","type":"string"},{"internalType":"bool","name":"revoked","type":"bool"}]},{"inputs":[{"internalType":"string","name":"_documentHash","type":"string"}],"stateMutability":"nonpayable","type":"function","name":"issueDocument"},{"inputs":[{"internalType":"string","name":"_documentHash","type":"string"}],"stateMutability":"nonpayable","type":"function","name":"revokeDocument"},{"inputs":[{"internalType":"string","name":"_documentHash","type":"string"},{"internalType":"address","name":"_newOwner","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"transferDocument"},{"inputs":[{"internalType":"string","name":"_documentHash","type":"string"}],"stateMutability":"view","type":"function","name":"verifyDocument","outputs":[{"internalType":"bool","name":"","type":"bool"}]}],"devdoc":{"kind":"dev","methods":{"issueDocument(string)":{"details":"Ensures the document is not already issued by checking the owner of the document hash.","params":{"_documentHash":"The unique hash of the document to be issued."}},"revokeDocument(string)":{"details":"Can only be called by the current owner of the document.","params":{"_documentHash":"The unique hash of the document to revoke."}},"transferDocument(string,address)":{"details":"Can only be called by the current owner and the document must not be revoked.","params":{"_documentHash":"The unique hash of the document to transfer.","_newOwner":"The address of the new owner of the document."}},"verifyDocument(string)":{"params":{"_documentHash":"The unique hash of the document to verify."},"returns":{"_0":"Returns true if the document is valid (not revoked and exists), false otherwise."}}},"version":1},"userdoc":{"kind":"user","methods":{"documents(string)":{"notice":"A mapping of document hashes to their corresponding Document details."},"issueDocument(string)":{"notice":"Function to issue a new document by associating its hash with the sender's address."},"revokeDocument(string)":{"notice":"Function to revoke a document."},"transferDocument(string,address)":{"notice":"Function to transfer ownership of a document to a new address."},"verifyDocument(string)":{"notice":"Function to verify if a document is valid (exists and is not revoked)."}},"version":1}},"settings":{"remappings":["@openzeppelin/contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/","ds-test/=lib/openzeppelin-contracts/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-contracts/=lib/openzeppelin-contracts/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/DocumentRegistry.sol":"DocumentRegistry"},"evmVersion":"paris","libraries":{}},"sources":{"src/DocumentRegistry.sol":{"keccak256":"0xf408a80f719d35ff628beff796f5350a092ef565d0ca76d259599d956e27f187","urls":["bzz-raw://534a0bc5dd9fa3103de7540fa736b51536d05d6f6e4e64c7cde591301546f9ab","dweb:/ipfs/QmQZGPtvvAj4ufLbkcy9rkW8chZRS7XQ1D4P4xykGNjUah"],"license":"MIT"}},"version":1},"id":20}], signer);
                    return contract;
                } catch (error) {
                    console.error("User denied wallet connection", error);
                    document.getElementById('status').textContent = "Wallet connection failed";
                }
            } else {
                document.getElementById('status').textContent = "No wallet found. Please install MetaMask!";
            }
        }

        // Verify document function
        async function verifyDocument() {
            const fileInput = document.getElementById('documentFile');
            const file = fileInput.files[0];

            if (!file) {
                document.getElementById('status').textContent = "Please select a document to verify.";
                return;
            }

            // Generate document hash
            const documentHash = await hashDocument(file);
            console.log('Generated Document Hash:', documentHash);

            // Connect wallet and get contract instance with signer
            const contract = await connectWallet();

            if (contract) {
                try {
                    const isVerified = await contract.verifyDocument(documentHash);
                    document.getElementById('status').textContent = isVerified ? "Document is valid" : "Document is invalid";
                } catch (error) {
                    console.error("Error while verifying document:", error);
                    document.getElementById('status').textContent = "Error verifying document";
                }
            }
        }

        // Event listener for verify button
        document.getElementById('verifyButton').addEventListener('click', verifyDocument);
    </script>
</body>
</html>
